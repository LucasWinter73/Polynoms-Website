<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Polynomial Interpolation</title>
	<link rel="icon" href="Assets/Polycalcs.png" type="image/png" />
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}

		body {
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
			background: linear-gradient(180deg, #f5f5f7 0%, #ffffff 100%);
			min-height: 100vh;
			padding: 40px 20px;
			display: flex;
			justify-content: center;
			align-items: center;
		}

		.container {
			background: rgba(255, 255, 255, 0.9);
			backdrop-filter: blur(20px);
			border-radius: 30px;
			padding: 60px 50px;
			max-width: 1000px;
			width: 100%;
			box-shadow: 0 20px 60px rgba(0, 0, 0, 0.08), 
						0 0 1px rgba(0, 0, 0, 0.1);
			animation: fadeIn 0.6s ease-out;
		}

		@keyframes fadeIn {
			from {
				opacity: 0;
				transform: translateY(20px);
			}
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}

		h1 {
			background: linear-gradient(135deg, #007AFF 0%, #5856D6 50%, #AF52DE 100%);
			-webkit-background-clip: text;
			-webkit-text-fill-color: transparent;
			background-clip: text;
			font-size: 48px;
			font-weight: 700;
			margin-bottom: 10px;
			text-align: center;
			letter-spacing: -0.5px;
		}

		.subtitle {
			text-align: center;
			color: #86868b;
			margin-bottom: 50px;
			font-size: 18px;
			font-weight: 400;
		}

		.input-section {
			background: linear-gradient(135deg, rgba(0, 122, 255, 0.03) 0%, rgba(88, 86, 214, 0.03) 100%);
			padding: 30px;
			border-radius: 20px;
			margin-bottom: 30px;
			border: 1px solid rgba(0, 122, 255, 0.1);
			transition: all 0.3s ease;
		}

		.input-section:hover {
			border-color: rgba(0, 122, 255, 0.2);
			box-shadow: 0 8px 24px rgba(0, 122, 255, 0.08);
		}

		.point-input {
			display: flex;
			gap: 12px;
			margin-bottom: 20px;
			align-items: center;
		}

		input[type="number"] {
			flex: 1;
			padding: 16px 20px;
			border: 1.5px solid #d2d2d7;
			border-radius: 12px;
			font-size: 17px;
			transition: all 0.3s ease;
			background: white;
			color: #1d1d1f;
		}

		input[type="number"]:focus {
			outline: none;
			border-color: #007AFF;
			box-shadow: 0 0 0 4px rgba(0, 122, 255, 0.1);
			transform: translateY(-1px);
		}

		input[type="number"]::placeholder {
			color: #86868b;
		}

		button {
			padding: 16px 32px;
			border: none;
			border-radius: 12px;
			font-size: 17px;
			cursor: pointer;
			transition: all 0.3s ease;
			font-weight: 600;
			letter-spacing: -0.2px;
		}

		.btn-add {
			background: linear-gradient(135deg, #007AFF 0%, #5856D6 100%);
			color: white;
			width: 100%;
			box-shadow: 0 4px 16px rgba(0, 122, 255, 0.3);
		}

		.btn-add:hover {
			transform: translateY(-2px);
			box-shadow: 0 8px 24px rgba(0, 122, 255, 0.4);
		}

		.btn-add:active {
			transform: translateY(0);
		}

		.btn-remove {
			background: linear-gradient(135deg, #FF3B30 0%, #FF2D55 100%);
			color: white;
			padding: 10px 20px;
			font-size: 14px;
			box-shadow: 0 2px 8px rgba(255, 59, 48, 0.3);
		}

		.btn-remove:hover {
			transform: translateY(-2px);
			box-shadow: 0 4px 12px rgba(255, 59, 48, 0.4);
		}

		.btn-calculate {
			background: linear-gradient(135deg, #0099ff 0%, #d056d6 100%);
			color: white;
			width: 100%;
			padding: 18px;
			font-size: 19px;
			box-shadow: 0 4px 16px rgba(0, 122, 255, 0.3);
		}

		.btn-calculate:hover {
			transform: translateY(-2px);
			box-shadow: 0 8px 24px rgba(0, 122, 255, 0.4);
		}

		.btn-calculate:active {
			transform: translateY(0);
		}

		.points-list {
			margin-bottom: 30px;
		}

		.point-item {
			background: white;
			padding: 18px 24px;
			border-radius: 14px;
			margin-bottom: 12px;
			display: flex;
			justify-content: space-between;
			align-items: center;
			box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
			border: 1px solid #f5f5f7;
			animation: slideIn 0.3s ease-out;
			transition: all 0.3s ease;
		}

		.point-item:hover {
			transform: translateX(4px);
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
		}

		@keyframes slideIn {
			from {
				opacity: 0;
				transform: translateX(-20px);
			}
			to {
				opacity: 1;
				transform: translateX(0);
			}
		}

		.result-section {
			background: linear-gradient(135deg, rgba(88, 86, 214, 0.03) 0%, rgba(175, 82, 222, 0.03) 100%);
			padding: 30px;
			border-radius: 20px;
			margin-top: 30px;
			opacity: 0;
			transform: translateY(20px);
			transition: all 0.5s ease;
			pointer-events: none;
			border: 1px solid rgba(88, 86, 214, 0.1);
		}

		.result-section.visible {
			opacity: 1;
			transform: translateY(0);
			pointer-events: all;
		}

		.polynomial {
			background: white;
			padding: 24px 28px;
			border-radius: 14px;
			font-family: 'SF Mono', 'Monaco', 'Courier New', monospace;
			font-size: 16px;
			word-wrap: break-word;
			margin-top: 15px;
			border-left: 4px solid #007AFF;
			box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
			color: #1d1d1f;
			line-height: 1.6;
		}

		.canvas-container {
			margin-top: 30px;
			background: white;
			padding: 30px;
			border-radius: 18px;
			display: flex;
			justify-content: center;
			box-shadow: 0 4px 16px rgba(0, 0, 0, 0.06);
			border: 1px solid #f5f5f7;
			position: relative;
			width: 100%;
		}

		canvas {
			border-radius: 12px;
			max-width: 100%;
			height: auto;
		}

		.label {
			font-weight: 600;
			background: linear-gradient(135deg, #007AFF 0%, #5856D6 100%);
			-webkit-background-clip: text;
			-webkit-text-fill-color: transparent;
			background-clip: text;
			margin-bottom: 12px;
			font-size: 15px;
			letter-spacing: -0.2px;
			text-transform: uppercase;
		}

		.point-item span {
			color: #1d1d1f;
			font-weight: 500;
			font-size: 16px;
		}

		.degree-badge {
			display: inline-block;
			background: linear-gradient(135deg, #007AFF 0%, #5856D6 100%);
			color: white;
			padding: 6px 16px;
			border-radius: 20px;
			font-weight: 600;
			font-size: 14px;
			margin-left: 10px;
			box-shadow: 0 2px 8px rgba(0, 122, 255, 0.3);
		}

		.empty-state {
			text-align: center;
			color: #86868b;
			padding: 40px;
			font-size: 16px;
		}

		@media (max-width: 768px) {
			.container {
				padding: 40px 30px;
			}
			
			h1 {
				font-size: 36px;
			}
			
			.subtitle {
				font-size: 16px;
			}
		}
	</style>
</head>
<body>
	<div class="container">
		<h1>Polynomial Interpolation</h1>
		<p class="subtitle">Enter points to generate a polynomial that passes through all of them</p>

		<div class="input-section">
			<div class="label">Add Points (x, y)</div>
			<div class="point-input">
				<input type="number" id="xInput" placeholder="x coordinate" step="any">
				<input type="number" id="yInput" placeholder="y coordinate" step="any">
			</div>
			<button class="btn-add" onclick="addPoint()">Add Point</button>
		</div>

		<div class="points-list" id="pointsList"></div>

		<button class="btn-calculate" onclick="calculatePolynomial()">Calculate Polynomial</button>

		<div class="result-section" id="resultSection">
			<div class="label">Polynomial Equation</div>
			<div class="polynomial" id="polynomialOutput"></div>
			<div style="margin-top: 24px;">
				<span class="label">Degree</span>
				<span class="degree-badge" id="degreeOutput"></span>
			</div>
			<div class="canvas-container">
				<canvas id="graph"></canvas>
			</div>
		</div>
	</div>

	<script>
		let points = [];

		function addPoint() {
			const xInput = document.getElementById('xInput');
			const yInput = document.getElementById('yInput');
			const x = parseFloat(xInput.value);
			const y = parseFloat(yInput.value);

			if (isNaN(x) || isNaN(y)) {
				alert('Please enter valid numbers for both coordinates');
				return;
			}

			points.push({ x, y });
			xInput.value = '';
			yInput.value = '';
			xInput.focus();
			updatePointsList();
		}

		function removePoint(index) {
			points.splice(index, 1);
			updatePointsList();
			if (points.length > 0) {
				calculatePolynomial();
			} else {
				document.getElementById('resultSection').classList.remove('visible');
			}
		}

		function updatePointsList() {
			const list = document.getElementById('pointsList');
			if (points.length === 0) {
				list.innerHTML = '';
				return;
			}

			list.innerHTML = '<div class="label">Points</div>';
			points.forEach((point, index) => {
				const item = document.createElement('div');
				item.className = 'point-item';
				item.innerHTML = `
					<span>Point ${index + 1}: (${point.x}, ${point.y})</span>
					<button class="btn-remove" onclick="removePoint(${index})">Remove</button>
				`;
				list.appendChild(item);
			});
		}

		function lagrangeInterpolation(points, x) {
			let result = 0;
			const n = points.length;

			for (let i = 0; i < n; i++) {
				let term = points[i].y;
				for (let j = 0; j < n; j++) {
					if (i !== j) {
						term *= (x - points[j].x) / (points[i].x - points[j].x);
					}
				}
				result += term;
			}
			return result;
		}

		function getPolynomialCoefficients(points) {
			const n = points.length;
			const coeffs = new Array(n).fill(0);

			for (let i = 0; i < n; i++) {
				let basis = [1];
				
				for (let j = 0; j < n; j++) {
					if (i !== j) {
						const newBasis = new Array(basis.length + 1).fill(0);
						for (let k = 0; k < basis.length; k++) {
							newBasis[k] += basis[k] * (-points[j].x);
							newBasis[k + 1] += basis[k];
						}
						basis = newBasis;
						
						const denom = points[i].x - points[j].x;
						basis = basis.map(c => c / denom);
					}
				}
				
				for (let k = 0; k < basis.length; k++) {
					coeffs[k] += basis[k] * points[i].y;
				}
			}

			return coeffs;
		}

		function formatPolynomial(coeffs) {
			let terms = [];
			const n = coeffs.length;

			for (let i = n - 1; i >= 0; i--) {
				const coeff = coeffs[i];
				if (Math.abs(coeff) < 1e-10) continue;

				const absCoeff = Math.abs(coeff);
				const sign = coeff > 0 ? '+' : '-';
				const coeffStr = absCoeff.toFixed(4).replace(/\.?0+$/, '');

				if (i === 0) {
					terms.push(`${sign} ${coeffStr}`);
				} else if (i === 1) {
					terms.push(`${sign} ${coeffStr}x`);
				} else {
					terms.push(`${sign} ${coeffStr}x^${i}`);
				}
			}

			if (terms.length === 0) return 'P(x) = 0';

			let result = 'P(x) = ' + terms.join(' ');
			if (result.startsWith('P(x) = +')) {
				result = result.replace('P(x) = +', 'P(x) = ');
			}
			return result;
		}

		function calculatePolynomial() {
			if (points.length === 0) {
				alert('Please add at least one point');
				return;
			}

			const coeffs = getPolynomialCoefficients(points);
			const polynomialStr = formatPolynomial(coeffs);
			
			document.getElementById('polynomialOutput').textContent = polynomialStr;
			document.getElementById('degreeOutput').textContent = points.length - 1;
			document.getElementById('resultSection').classList.add('visible');

			drawGraph();
		}

		function drawGraph() {
			const canvas = document.getElementById('graph');
			const ctx = canvas.getContext('2d');
			
			// Set canvas size with device pixel ratio for sharp rendering
			const containerWidth = canvas.parentElement.clientWidth - 60;
			const containerHeight = Math.min(450, window.innerHeight * 0.5);
			const dpr = window.devicePixelRatio || 1;
			
			canvas.width = containerWidth * dpr;
			canvas.height = containerHeight * dpr;
			canvas.style.width = containerWidth + 'px';
			canvas.style.height = containerHeight + 'px';
			
			ctx.scale(dpr, dpr);
			
			const width = containerWidth;
			const height = containerHeight;

			ctx.clearRect(0, 0, width, height);

			if (points.length === 0) return;

			const xValues = points.map(p => p.x);
			const yValues = points.map(p => p.y);
			const xMin = Math.min(...xValues) - 1;
			const xMax = Math.max(...xValues) + 1;
			const yMin = Math.min(...yValues) - 1;
			const yMax = Math.max(...yValues) + 1;

			const xRange = xMax - xMin;
			const yRange = yMax - yMin;

			const padding = 60;

			function toCanvasX(x) {
				return ((x - xMin) / xRange) * (width - 2 * padding) + padding;
			}

			function toCanvasY(y) {
				return height - padding - ((y - yMin) / yRange) * (height - 2 * padding);
			}

			ctx.fillStyle = '#86868b';
			ctx.font = '13px -apple-system, BlinkMacSystemFont, sans-serif';
			ctx.textAlign = 'center';

			function getNiceStep(range) {
				const rawStep = range / 8;
				const magnitude = Math.pow(10, Math.floor(Math.log10(rawStep)));
				const normalized = rawStep / magnitude;
				let niceNormalized;
				if (normalized < 1.5) niceNormalized = 1;
				else if (normalized < 3) niceNormalized = 2;
				else if (normalized < 7) niceNormalized = 5;
				else niceNormalized = 10;
				return niceNormalized * magnitude;
			}

			const xStep = getNiceStep(xRange);
			const yStep = getNiceStep(yRange);

			ctx.strokeStyle = '#f5f5f7';
			ctx.lineWidth = 1;

			const xStart = Math.ceil(xMin / xStep) * xStep;
			for (let x = xStart; x <= xMax; x += xStep) {
				const canvasX = toCanvasX(x);
				ctx.beginPath();
				ctx.moveTo(canvasX, padding);
				ctx.lineTo(canvasX, height - padding);
				ctx.stroke();

				ctx.fillStyle = '#86868b';
				ctx.fillText(x.toFixed(2).replace(/\.?0+$/, ''), canvasX, height - padding + 20);
			}

			const yStart = Math.ceil(yMin / yStep) * yStep;
			for (let y = yStart; y <= yMax; y += yStep) {
				const canvasY = toCanvasY(y);
				ctx.beginPath();
				ctx.moveTo(padding, canvasY);
				ctx.lineTo(width - padding, canvasY);
				ctx.stroke();

				ctx.fillStyle = '#86868b';
				ctx.textAlign = 'right';
				ctx.fillText(y.toFixed(2).replace(/\.?0+$/, ''), padding - 10, canvasY + 4);
			}

			ctx.strokeStyle = '#d2d2d7';
			ctx.lineWidth = 2;
			ctx.beginPath();
			ctx.moveTo(padding, toCanvasY(0));
			ctx.lineTo(width - padding, toCanvasY(0));
			ctx.stroke();
			ctx.beginPath();
			ctx.moveTo(toCanvasX(0), padding);
			ctx.lineTo(toCanvasX(0), height - padding);
			ctx.stroke();

			ctx.fillStyle = '#1d1d1f';
			ctx.font = 'bold 15px -apple-system, BlinkMacSystemFont, sans-serif';
			ctx.textAlign = 'center';
			ctx.fillText('x', width - padding + 20, toCanvasY(0) + 5);
			ctx.save();
			ctx.translate(padding - 40, height / 2);
			ctx.rotate(-Math.PI / 2);
			ctx.fillText('y', 0, 0);
			ctx.restore();

			const gradient = ctx.createLinearGradient(0, 0, width, 0);
			gradient.addColorStop(0, '#007AFF');
			gradient.addColorStop(0.5, '#5856D6');
			gradient.addColorStop(1, '#AF52DE');
			
			ctx.strokeStyle = gradient;
			ctx.lineWidth = 3;
			ctx.shadowColor = 'rgba(0, 122, 255, 0.3)';
			ctx.shadowBlur = 8;
			ctx.beginPath();
			for (let i = 0; i <= 500; i++) {
				const x = xMin + (i / 500) * xRange;
				const y = lagrangeInterpolation(points, x);
				const canvasX = toCanvasX(x);
				const canvasY = toCanvasY(y);

				if (i === 0) {
					ctx.moveTo(canvasX, canvasY);
				} else {
					ctx.lineTo(canvasX, canvasY);
				}
			}
			ctx.stroke();
			ctx.shadowBlur = 0;

			points.forEach(point => {
				const pointGradient = ctx.createRadialGradient(
					toCanvasX(point.x), toCanvasY(point.y), 0,
					toCanvasX(point.x), toCanvasY(point.y), 8
				);
				pointGradient.addColorStop(0, '#0099ff');
				pointGradient.addColorStop(1, '#4e5052');
				
				ctx.fillStyle = pointGradient;
				ctx.beginPath();
				ctx.arc(toCanvasX(point.x), toCanvasY(point.y), 7, 0, 2 * Math.PI);
				ctx.fill();
				ctx.strokeStyle = 'white';
				ctx.lineWidth = 3;
				ctx.stroke();
				ctx.shadowColor = 'rgba(0, 122, 255, 0.3)';
				ctx.shadowBlur = 8;
				ctx.stroke();
				ctx.shadowBlur = 0;
			});
		}

		document.getElementById('xInput').addEventListener('keypress', function(e) {
			if (e.key === 'Enter') {
				document.getElementById('yInput').focus();
			}
		});

		document.getElementById('yInput').addEventListener('keypress', function(e) {
			if (e.key === 'Enter') {
				addPoint();
			}
		});

		// Redraw graph on window resize
		let resizeTimeout;
		window.addEventListener('resize', function() {
			clearTimeout(resizeTimeout);
			resizeTimeout = setTimeout(function() {
				if (points.length > 0) {
					drawGraph();
				}
			}, 250);
		});
	</script>
</body>
</html>